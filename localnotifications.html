<html>
<head>
<meta name = "viewport" content = "initial-scale = 1.0, user-scalable = no" />
<link rel="stylesheet" href="style.css" type="text/css">
<script type="text/javascript" src="NKit.js"></script>
</head>

<body>

<script>

	var navController = new NKNavigationController();
	navController.setTitle("Local Notifications");
	NKSetPageOpaque('localnotifications.html', 'NO');
		
	function notify()	{
	
	// =====================================================================================================
	//	PARAMETERS:
	// =====================================================================================================
	//	body:		The Body of the notification. (Title is your app's name)
	// -----------------------------------------------------------------------------------------------------
	//	action:		The alert action is title of the r/h button of alert or the value of unlock slider.
	//				The value replaces “unlock” in the “slide to unlock” dialogue.
	// -----------------------------------------------------------------------------------------------------
	//	badgeNum:	The number to display as the application’s icon badge.
	// -----------------------------------------------------------------------------------------------------
	//	fire:		The date and time when the system should deliver the notification.
	//				Currently accepts the format: 2012-07-31 17:14:30
	//				You can tweak the NSDateFormatter to accept other formats if you so desire.
	// -----------------------------------------------------------------------------------------------------
	//	id:			Set a unique ID for the notification // TODO
	// -----------------------------------------------------------------------------------------------------
	//	sound:		Leave Blank for no sound, use "UILocalNotificationDefaultSoundName" (default value), or 
	//				you can specify a custom sound file in the applications bundle. 
	//				Must be less than 30secs, otherwise the standard system sound will play instead.
	// -----------------------------------------------------------------------------------------------------
	//	repeat:		When to repeat the notification. Default of "0" is never, other options are:
	//				1 = NSMinuteCalendarUnit
	//				2 = NSHourCalendarUnit
	//				3 = NSDayCalendarUnit
	//				4 = NSWeekCalendarUnit
	//				5 = NSMonthCalendarUnit
	// -----------------------------------------------------------------------------------------------------
	//
	//	MISCELLANEOUS:
	//	Each application on a device is limited to the soonest-firing 64 scheduled local notifications. 
	//	iOS discards notifications that exceed this limit (although recurring notifications are considered 
	//	to be a single notification).
	//
	// -----------------------------------------------------------------------------------------------------

	// Register The Notification Class
	NKRegisterClass("localNotification");

	var bc = new NKApplication();
	bc.setBadgeCount("0");

	// TESTING 123... Set a future date to use for notification
	//var dateFire = new Date();
	//dateFire = dateFire.getTime() + 60*1000; //1 minute from now
	//dateFire = new Date(dateFire);


	body = 'Lovely Great Message';
	action = 'Show';
	badgeNum = '123';
	fireAt = '2012-02-19 14:09:30';
	id = 'ABC123';
	sound = 'UILocalNotificationDefaultSoundName';
	repeat = '1';

	CallNKitAction("addNotification?className=localNotification&body="+body+"&action="+action+"&sound="+sound+"&badgeNum="+badgeNum+"&fire="+fireAt+"&id="+id+"&repInt="+repeat); 

	}

	//function cancel() {
	//	CallNKitAction("cancelNotification?className=localNotification");
	//}

	function cancelAll() {
		CallNKitAction("cancelAllNotifications?className=localNotification");
		// Set Badge count to zero...
	}

	</script>

<div class="infobox">
	<h3>ToDo:</h3>
	<p>Implement dictionary for setting notification ID's, to allow for notification management</p>
	<p>Improve date &amp; time handling - more flexibility needed</p>
</div>

<div class="greybutton" onClick="notify()">Set Notification</a></div>
<div class="greybutton" onClick="cancelAll()">Cancel All Notifications</a></div>
<!-- <div class="greybutton" onClick="cancel()">Cancel Specific Notification</a></div> -->
</body>
</html>